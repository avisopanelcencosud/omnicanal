El programa se esta ejecutando...
Inicio Programa: 15/09/17 01:33:08

sFechaIni: 14-09-2017

sFechaFin: 14-09-2017

sFechaFin2: 20170914

secuencia2: 48

Query : SELECT ' ' as ASNID ,PO.ext_purchase_orders_id as SHIPMENT_ID ,o.O_FACILITY_ALIAS_ID     as Origen,NVL(o.D_FACILITY_ALIAS_ID,'CLIENTE')     as Destino , PO.tc_purchase_orders_id as BILL_OF_LADING_NUMBER  ,ot.order_type as BILL_OF_LADING_NUMBER_1 ,O.tc_order_id              as N_Orden_Distribu ,POL.sku                    as SKU ,POL.tc_po_line_id          as Linea_PO ,sum(POL.allocated_qty)          as Cant_Desc_SKU ,' ' as LPN_ID ,PO.created_dttm            as Fecha ,' ' as MANIF_NBR ,POS.description            as Est_Orden   ,POS2.description           as Estado_de_Linea ,CASE  WHEN POL.order_fulfillment_option = '01' THEN 'BOPIS' WHEN POL.order_fulfillment_option = '02' THEN 'CLICK AND COLLECT' ELSE 'DESP.DOM.' END AS Bopis_CC FROM CA14.purchase_orders po  INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL   ON pol.purchase_orders_id = po.purchase_orders_id INNER JOIN CA14.purchase_orders_status pos  ON pos.purchase_orders_status = po.purchase_orders_status INNER JOIN CA14.order_type ot ON ot.order_type_id = po.order_category INNER JOIN CA14.item_cbo ic ON ic.item_id = POL.SKU_ID INNER JOIN CA14.order_line_item OLI ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID  AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID AND Oli.Is_Cancelled = 0 LEFT JOIN CA14.orders o ON o.Order_ID = OLI.Order_ID AND o.purchase_order_id =  po.purchase_orders_id AND o.IS_CANCELLED = 0 INNER JOIN CA14.purchase_orders_status pos2  ON pos2.purchase_orders_status = pol.purchase_orders_line_status INNER JOIN CA14.DO_status sts   ON o.do_status = sts.order_status    WHERE ot.order_type_id in(6)  AND PO.is_purchase_orders_confirmed = '1' AND PO.created_dttm >= to_date('14-09-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND PO.created_dttm <= to_date('14-09-2017 23:59:59','DD-MM-YYYY HH24:MI:SS')  AND o.D_FACILITY_ALIAS_ID IS NULL  AND pol.purchase_orders_line_status <> 940 GROUP BY PO.ext_purchase_orders_id,o.O_FACILITY_ALIAS_ID,o.D_FACILITY_ALIAS_ID,PO.tc_purchase_orders_id,O.tc_order_id,POL.tc_po_line_id,POL.sku, PO.created_dttm, POS.description, POS2.description, POL.order_fulfillment_option,ot.order_type  UNION SELECT ' ' as ASNID ,PO.ext_purchase_orders_id as SHIPMENT_ID ,o.O_FACILITY_ALIAS_ID     as Origen ,NVL(o.D_FACILITY_ALIAS_ID,'CLIENTE')     as Destino , PO.tc_purchase_orders_id as BILL_OF_LADING_NUMBER  ,ot.order_type as BILL_OF_LADING_NUMBER ,O.tc_order_id              as N_Orden_Distribu ,POL.sku                    as SKU ,POL.tc_po_line_id          as Linea_PO ,sum(POL.allocated_qty)          as Cant_Desc_SKU ,' ' as LPN_ID ,PO.created_dttm            as Fecha ,' ' as MANIF_NBR ,POS.description            as Est_Orden   ,POS2.description           as Estado_de_Linea ,CASE  WHEN POL.order_fulfillment_option = '01' THEN 'BOPIS' WHEN POL.order_fulfillment_option = '02' THEN 'CLICK AND COLLECT' ELSE 'DESP.DOM.' END AS Bopis_CC FROM CA14.purchase_orders po INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL  ON pol.purchase_orders_id = po.purchase_orders_id INNER JOIN CA14.purchase_orders_status pos ON pos.purchase_orders_status = po.purchase_orders_status INNER JOIN CA14.order_type ot ON ot.order_type_id = po.order_category INNER JOIN CA14.item_cbo ic  ON ic.item_id = POL.SKU_ID INNER JOIN CA14.order_line_item OLI ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID AND Oli.Is_Cancelled = 0 LEFT JOIN CA14.orders o  ON o.Order_ID = OLI.Order_ID AND o.purchase_order_id =  po.purchase_orders_id  AND o.IS_CANCELLED = 0 INNER JOIN CA14.purchase_orders_status pos2 ON pos2.purchase_orders_status = pol.purchase_orders_line_status INNER JOIN CA14.DO_status sts ON o.do_status = sts.order_status WHERE PO.is_purchase_orders_confirmed = '1' AND ot.order_type_id in(22,42)  AND POL.order_fulfillment_option = '02' AND PO.created_dttm >= to_date('14-09-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND PO.created_dttm <= to_date('14-09-2017 23:59:59','DD-MM-YYYY HH24:MI:SS') AND o.O_FACILITY_ALIAS_ID <> o.D_FACILITY_ALIAS_ID AND pol.purchase_orders_line_status <> 940 GROUP BY PO.ext_purchase_orders_id,o.O_FACILITY_ALIAS_ID,o.D_FACILITY_ALIAS_ID,PO.tc_purchase_orders_id,O.tc_order_id,POL.tc_po_line_id,POL.sku, PO.created_dttm, POS.description, POS2.description, POL.order_fulfillment_option,ot.order_type  UNION SELECT ' ' as ASNID ,PO.ext_purchase_orders_id as SHIPMENT_ID ,o.O_FACILITY_ALIAS_ID     as Origen ,NVL(o.D_FACILITY_ALIAS_ID,'CLIENTE')     as Destino , PO.tc_purchase_orders_id as BILL_OF_LADING_NUMBER   ,ot.order_type as BILL_OF_LADING_NUMBER_1 ,O.tc_order_id              as N_Orden_Distribu ,POL.sku                    as SKU ,POL.tc_po_line_id          as Linea_PO ,sum(POL.allocated_qty)          as Cant_Desc_SKU ,' ' as LPN_ID ,PO.created_dttm            as Fecha ,' ' as MANIF_NBR ,POS.description            as Est_Orden ,POS2.description           as Estado_de_Linea ,CASE WHEN POL.order_fulfillment_option = '01' THEN 'BOPIS' WHEN POL.order_fulfillment_option = '02' THEN 'CLICK AND COLLECT' ELSE 'DESP.DOM.' END AS Bopis_CC FROM CA14.purchase_orders po INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL ON pol.purchase_orders_id = po.purchase_orders_id INNER JOIN CA14.purchase_orders_status pos ON pos.purchase_orders_status = po.purchase_orders_status INNER JOIN CA14.order_type ot ON ot.order_type_id = po.order_category INNER JOIN CA14.item_cbo ic ON ic.item_id = POL.SKU_ID INNER JOIN CA14.order_line_item OLI ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID AND Oli.Is_Cancelled = 0 LEFT JOIN CA14.orders o ON o.Order_ID = OLI.Order_ID AND o.purchase_order_id =  po.purchase_orders_id AND o.IS_CANCELLED = 0 INNER JOIN CA14.purchase_orders_status pos2 ON pos2.purchase_orders_status = pol.purchase_orders_line_status INNER JOIN CA14.DO_status sts ON o.do_status = sts.order_status WHERE PO.is_purchase_orders_confirmed = '1' AND ot.order_type_id in(42)  AND POL.order_fulfillment_option = '01' AND PO.created_dttm >= to_date('14-09-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND PO.created_dttm <= to_date('14-09-2017 23:59:59','DD-MM-YYYY HH24:MI:SS') AND pol.purchase_orders_line_status <> 940  GROUP BY PO.ext_purchase_orders_id,o.O_FACILITY_ALIAS_ID,o.D_FACILITY_ALIAS_ID,PO.tc_purchase_orders_id,O.tc_order_id,POL.tc_po_line_id,POL.sku, PO.created_dttm, POS.description, POS2.description, POL.order_fulfillment_option,ot.order_type 

Pausa de (60 seg)
Query2 : SELECT SUM(1) as total FROM ( SELECT SUM(1) as total  FROM CA14.purchase_orders po  INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL   ON pol.purchase_orders_id = po.purchase_orders_id INNER JOIN CA14.purchase_orders_status pos  ON pos.purchase_orders_status = po.purchase_orders_status INNER JOIN CA14.order_type ot ON ot.order_type_id = po.order_category INNER JOIN CA14.item_cbo ic ON ic.item_id = POL.SKU_ID INNER JOIN CA14.order_line_item OLI ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID  AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID AND Oli.Is_Cancelled = 0 LEFT JOIN CA14.orders o ON o.Order_ID = OLI.Order_ID AND o.purchase_order_id =  po.purchase_orders_id AND o.IS_CANCELLED = 0 INNER JOIN CA14.purchase_orders_status pos2  ON pos2.purchase_orders_status = pol.purchase_orders_line_status INNER JOIN CA14.DO_status sts   ON o.do_status = sts.order_status    WHERE ot.order_type_id in(6)  AND PO.is_purchase_orders_confirmed = '1' AND PO.created_dttm >= to_date('14-09-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND PO.created_dttm <= to_date('14-09-2017 23:59:59','DD-MM-YYYY HH24:MI:SS')  AND o.D_FACILITY_ALIAS_ID IS NULL  AND pol.purchase_orders_line_status <> 940 GROUP BY PO.ext_purchase_orders_id,o.O_FACILITY_ALIAS_ID,o.D_FACILITY_ALIAS_ID,PO.tc_purchase_orders_id,O.tc_order_id,POL.tc_po_line_id,POL.sku, PO.created_dttm, POS.description, POS2.description, POL.order_fulfillment_option,ot.order_type  UNION ALL SELECT SUM(1) as total FROM CA14.purchase_orders po INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL  ON pol.purchase_orders_id = po.purchase_orders_id INNER JOIN CA14.purchase_orders_status pos ON pos.purchase_orders_status = po.purchase_orders_status INNER JOIN CA14.order_type ot ON ot.order_type_id = po.order_category INNER JOIN CA14.item_cbo ic  ON ic.item_id = POL.SKU_ID INNER JOIN CA14.order_line_item OLI ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID AND Oli.Is_Cancelled = 0 LEFT JOIN CA14.orders o  ON o.Order_ID = OLI.Order_ID AND o.purchase_order_id =  po.purchase_orders_id  AND o.IS_CANCELLED = 0 INNER JOIN CA14.purchase_orders_status pos2 ON pos2.purchase_orders_status = pol.purchase_orders_line_status INNER JOIN CA14.DO_status sts ON o.do_status = sts.order_status WHERE PO.is_purchase_orders_confirmed = '1' AND ot.order_type_id in(22,42)  AND POL.order_fulfillment_option = '02' AND PO.created_dttm >= to_date('14-09-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND PO.created_dttm <= to_date('14-09-2017 23:59:59','DD-MM-YYYY HH24:MI:SS') AND o.O_FACILITY_ALIAS_ID <> o.D_FACILITY_ALIAS_ID AND pol.purchase_orders_line_status <> 940 GROUP BY PO.ext_purchase_orders_id,o.O_FACILITY_ALIAS_ID,o.D_FACILITY_ALIAS_ID,PO.tc_purchase_orders_id,O.tc_order_id,POL.tc_po_line_id,POL.sku, PO.created_dttm, POS.description, POS2.description, POL.order_fulfillment_option,ot.order_type  UNION ALL SELECT SUM(1) as total FROM CA14.purchase_orders po INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL ON pol.purchase_orders_id = po.purchase_orders_id INNER JOIN CA14.purchase_orders_status pos ON pos.purchase_orders_status = po.purchase_orders_status INNER JOIN CA14.order_type ot ON ot.order_type_id = po.order_category INNER JOIN CA14.item_cbo ic ON ic.item_id = POL.SKU_ID INNER JOIN CA14.order_line_item OLI ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID AND Oli.Is_Cancelled = 0 LEFT JOIN CA14.orders o ON o.Order_ID = OLI.Order_ID AND o.purchase_order_id =  po.purchase_orders_id AND o.IS_CANCELLED = 0 INNER JOIN CA14.purchase_orders_status pos2 ON pos2.purchase_orders_status = pol.purchase_orders_line_status INNER JOIN CA14.DO_status sts ON o.do_status = sts.order_status WHERE PO.is_purchase_orders_confirmed = '1' AND ot.order_type_id in(42)  AND POL.order_fulfillment_option = '01' AND PO.created_dttm >= to_date('14-09-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND PO.created_dttm <= to_date('14-09-2017 23:59:59','DD-MM-YYYY HH24:MI:SS') AND pol.purchase_orders_line_status <> 940  GROUP BY PO.ext_purchase_orders_id,o.O_FACILITY_ALIAS_ID,o.D_FACILITY_ALIAS_ID,PO.tc_purchase_orders_id,O.tc_order_id,POL.tc_po_line_id,POL.sku, PO.created_dttm, POS.description, POS2.description, POL.order_fulfillment_option,ot.order_type ) 

Pausa de (120 seg)
Infor = 416.00
Archivos creados.

Fin Programa: 15/09/17 01:33:08

El programa finalizo.
